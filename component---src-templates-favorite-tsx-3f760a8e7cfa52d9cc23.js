"use strict";(self.webpackChunkin_the_loop=self.webpackChunkin_the_loop||[]).push([[484],{746:function(e,t,n){n.d(t,{A:function(){return C}});n(4129);var a=n(6951),o=(n(5123),n(8037)),s=(n(8601),n(9693)),r=(n(5298),n(4448)),i=n(3826),l=n(6540),d=n(2388),u=n(6565),p=n(2240),m=n(7379),c=n(8217),h=n(436),b=(n(9283),n(1442)),k=(n(8110),n(5884)),w=n(6462),I=n(5268),y=n(2632),f=n(2118),v=n(8175);const A=[{dataIndex:"route",key:"route",width:75,render:(e,t)=>l.createElement(v.A,{type:t.transitType,route:e})},{dataIndex:["arrival","time"],key:"arrivalTime",width:150,render:e=>l.createElement(f.A,{dateStr:e})},{dataIndex:["arrival","time"],key:"timeUntilArrival",width:150,render:(e,t)=>l.createElement(y.A,{dateStr:e,isApproaching:t.arrival.isApproaching})}];var g=e=>{let{nextArrivals:t}=e;const[n,a]=l.useState([]),o=(0,w.useLocation)(),s=e=>{a((t=>t.includes(e.run)?t.filter((t=>t!==e.run)):[].concat((0,h.A)(t),[e.run])))};return l.createElement(b.A,{columns:A,dataSource:t,showHeader:!1,pagination:!1,rowKey:"run",expandable:{expandedRowRender:e=>(e=>{const t=()=>{(0,I.navigate)(`/follow?run=${e.run}`,{state:{source:o.pathname}})},n=[{dataIndex:"run",key:"run",width:75,render:e=>`#${e}`},{dataIndex:["departure","time"],key:"reachDestination",width:150,render:t=>e.departure?l.createElement("span",null,"Arrive ",l.createElement(f.A,{dateStr:t})):null},{key:"follow",width:150,render:()=>l.createElement(k.A,{type:"link",onClick:t},"Follow")}],a=[{...e}];return l.createElement(b.A,{columns:n,dataSource:a,pagination:!1,showHeader:!1,size:"small",rowKey:"run"})})(e),rowExpandable:()=>!0,expandedRowKeys:n,onExpand:(e,t)=>{s(t)}},onRow:e=>({style:{cursor:"pointer"},onClick:()=>s(e)})})},E="track-module--dropdownLabel--52f22",T="track-module--fullWidth--6b8b4";async function L(e){const t=e.map((async e=>{let{transitType:t,routes:n,arrival:a,departure:o}=e;const s=n.join(","),r=new URL("https://9fqgf0uli3.execute-api.us-east-2.amazonaws.com/Prod/in-the-loop/track-arrivals");r.searchParams.set("transit",t),r.searchParams.set("routes",s),r.searchParams.set("arrival",a),o&&r.searchParams.set("departure",o);try{console.log(`fetch track-arrivals: ${t} ${s} ${a} to ${o}`);const e=await fetch(r);if(!e.ok){console.error(`HTTP error! status: ${e.status}`);const t=await e.json();console.error(`Error response: ${JSON.stringify(t,null,2)}`)}const n=(await e.json()).arrivals;return n.sort(((e,t)=>new Date(e.arrival.time).getTime()-new Date(t.arrival.time).getTime())),n}catch(i){throw console.error("Error fetching arrival data:",i),i}}));return{response:await Promise.all(t),lastUpdated:new Date}}const x=e=>!!e&&(new Date).getTime()-e.getTime()<3e4;var C=e=>{var t,n;let{tracks:h,title:b,subtitle:k,destinations:w,routeFilter:I}=e;const[y,f]=l.useState((null==w||null===(t=w[0])||void 0===t?void 0:t.stopId)||""),[v,A]=l.useState((null==I?void 0:I.map((e=>e.id)))||[]),[C,S]=l.useState(!1),[P,N]=l.useState(!0),R=h.map((e=>({transitType:e.transitType,routes:e.routes,arrival:e.stopId,departure:y||void 0}))),{data:B,error:M,isValidating:z,mutate:D}=(0,u.Ay)(R,L,{refreshInterval:15e3,keepPreviousData:!0}),O=null==B||null===(n=B.response)||void 0===n?void 0:n.map((e=>e.filter((e=>!I||v.includes(e.route))))),W=null==B?void 0:B.lastUpdated,$=O&&O.length>0&&O[0].length>0;l.useEffect((()=>{!z&&P&&N(!1)}),[z]),l.useEffect((()=>{S(x(W));const e=setInterval((()=>{S(x(W))}),1e3);return()=>clearInterval(e)}),[W]);return l.createElement(p.A,null,l.createElement(p.A,{bottom:16},l.createElement("div",{className:"track-module--titleContainer--61fce"},l.createElement(c.A,{size:0},l.createElement("h2",{className:"track-module--titleText--80672"},b),k&&l.createElement("div",null,k)),l.createElement(c.A,{left:10,right:0},l.createElement(m.A,{isLive:C,onClick:()=>{D()}})))),w&&w.length&&l.createElement(p.A,{bottom:16},l.createElement("label",{className:E},"Destination Stop:"),l.createElement(r.A,{id:"destination-select",className:T,value:y,onChange:e=>{f(e)}},w.map((e=>l.createElement(r.A.Option,{key:e.stopId,value:e.stopId},e.name))))),I&&I.length>1&&l.createElement(p.A,{bottom:16},l.createElement("label",{className:E},"Routes:"),l.createElement(r.A,{mode:"multiple",id:"route-filter-select",className:T,value:v,onChange:e=>{A(e)},optionLabelProp:"value",allowClear:!0,showArrow:!0,showSearch:!1},I.map((e=>l.createElement(r.A.Option,{key:e.id,value:e.id},e.name))))),M?l.createElement(p.A,null,l.createElement(s.Ay,{status:"warning",title:l.createElement("span",{className:"track-module--errorTitle--881d5"},"Something went wrong"),subTitle:"We were unable to retrieve live CTA tracking data",icon:l.createElement(i.A,{className:"track-module--warningIcon--17ea9"})})):P?l.createElement(p.A,null,l.createElement(o.A,{active:!0})):$?null==O?void 0:O.map(((e,t)=>{var n,a;return e.length>0&&l.createElement(p.A,{size:16,key:t},l.createElement("h4",{className:"track-module--alignLeft--1c4a8"},null===(n=e[0])||void 0===n||null===(a=n.arrival)||void 0===a?void 0:a.stopName),l.createElement(g,{nextArrivals:e}))})):l.createElement(p.A,null,l.createElement(a.A,{description:"No upcoming arrivals found",image:l.createElement(d.Bsn,{size:84})})))}},2240:function(e,t,n){const a=(0,n(7581).default)("div").withConfig({shouldForwardProp:e=>!["centered","flex","top","bottom","size","width"].includes(e)}).attrs((e=>{let{size:t=8,top:n,bottom:a,width:o,centered:s=!1,flex:r=!1}=e;return{size:t,top:null!=n?n:t,bottom:null!=a?a:t,width:o,centered:s,flex:r}})).withConfig({displayName:"Container",componentId:"sc-1la7ue3-0"})(["margin:auto;padding-top:","px;padding-bottom:","px;"," "," ",""],(e=>e.top),(e=>e.bottom),(e=>{let{width:t}=e;return t&&`\n    max-width: ${t}px;\n  `}),(e=>{let{centered:t}=e;return t&&"\n    text-align: center;\n    justify-content: center;\n  "}),(e=>{let{flex:t}=e;return t&&"\n    display: flex;\n  "}));t.A=a},4308:function(e,t,n){n.r(t),n.d(t,{Head:function(){return l}});var a=n(6540),o=n(795),s=n(7506),r=n(2853),i=n(746);t.default=e=>{let{pageContext:t}=e;const n=t.tripKey,l=s.X[n];return a.createElement(r.A,null,a.createElement(o.A,{paths:[{to:"/favorites",text:"Select New Trip"}]}),a.createElement(i.A,{tracks:l.options,title:l.name,destinations:l.destinations}))};const l=()=>a.createElement("title",null,"In The Loop")},7506:function(e,t,n){n.d(t,{X:function(){return o},m:function(){return a}});const a={outbound:["ashland-adams-northbound","ashland-to-loop","madison-ashland-eastbound","clark-lake-northbound","lake-northbound","ashland-adams-southbound","division-to-ohare","ashland-to-midway","jackson-ashland-eastbound"],inbound:["ashland-lake-southbound","clark-lake-to-home","state-lake-to-home","madison-lasalle-westbound","madison-wabash-westbound","aon-center-westbound","sedgwick-southbound","belmont-southbound","adison-southbound"]},o={"ashland-to-loop":{name:"Ashland to Loop",options:[{transitType:"train",stopId:"30032",routes:["Pink","Green"]}],destinations:[{name:"Clark/Lake",stopId:"30074"},{name:"State/Lake",stopId:"30050"},{name:"Roosevelt",stopId:"30081"}]},"clinton-to-loop":{name:"Clinton to Loop",options:[{transitType:"train",stopId:"30221",routes:["Pink","Green"]}],destinations:[{name:"Clark/Lake",stopId:"30074"}]},"ashland-adams-northbound":{name:"Ashland & Adams Northbound",options:[{transitType:"bus",stopId:"17177",routes:["9"]},{transitType:"bus",stopId:"17076",routes:["X9"]}],destinations:[{name:"Ashland & Lake",stopId:"14783"},{name:"Ashland & Milwaukee",stopId:"6252"}]},"ashland-adams-southbound":{name:"Ashland & Adams Southbound",options:[{transitType:"bus",stopId:"6040",routes:["9"]},{transitType:"bus",stopId:"6041",routes:["X9"]}],destinations:[{name:"Ashland & Roosevelt",stopId:"6046"},{name:"Ashland Orange Line Station",stopId:"14476"}]},"madison-ashland-eastbound":{name:"Madison & Laflin Eastbound",options:[{transitType:"bus",stopId:"15279",routes:["20"]}],destinations:[{name:"Washington & Clark",stopId:"18122"},{name:"Washington & Wabash",stopId:"449"},{name:"Michigan & Randolph",stopId:"1119"}]},"division-to-ohare":{name:"Division to O'Hare",options:[{transitType:"train",stopId:"30062",routes:["Blue"]}],destinations:[{name:"O'Hare",stopId:"30171"}]},"ashland-to-midway":{name:"Ashland to Midway",options:[{transitType:"train",stopId:"30206",routes:["Orange"]}],destinations:[{name:"Midway",stopId:"30182"}]},"clark-lake-northbound":{name:"Clark/Lake Northbound",options:[{transitType:"train",stopId:"30075",routes:["Brown","Purple"]}],destinations:[{name:"Sedgwick",stopId:"30155"},{name:"Armitage",stopId:"30127"},{name:"Belmont",stopId:"30257"}]},"lake-northbound":{name:"Lake Northbound",options:[{transitType:"train",stopId:"30289",routes:["Red"]}],destinations:[{name:"Clark/Division",stopId:"30121"},{name:"Belmont",stopId:"30255"},{name:"Addison",stopId:"30273"}]},"jackson-ashland-eastbound":{name:"Jackson & Ashland Eastbound",options:[{transitType:"bus",stopId:"55",routes:["126"]},{transitType:"bus",stopId:"51",routes:["126"]}],destinations:[{name:"Jackson & Clinton",stopId:"14484"}]},"clark-lake-to-home":{name:"Clark/Lake To Home",options:[{transitType:"train",stopId:"30075",routes:["Green"]},{transitType:"train",stopId:"30074",routes:["Pink"]}],destinations:[{name:"Ashland",stopId:"30033"}]},"ashland-lake-southbound":{name:"Ashland & Lake Southbound",options:[{transitType:"bus",stopId:"6035",routes:["9","X9"]}],destinations:[{name:"Ashland & Adams",stopId:"6040"}]},"state-lake-to-home":{name:"State/Lake To Home",options:[{transitType:"train",stopId:"30051",routes:["Green"]},{transitType:"train",stopId:"30050",routes:["Pink"]}],destinations:[{name:"Ashland",stopId:"30033"}]},"madison-lasalle-westbound":{name:"Madison & LaSalle Westbound",options:[{transitType:"bus",stopId:"18123",routes:["20"]}],destinations:[{name:"Madison & Laflin",stopId:"464"}]},"madison-wabash-westbound":{name:"Madison & Wabash Westbound",options:[{transitType:"bus",stopId:"450",routes:["20"]}],destinations:[{name:"Madison & Laflin",stopId:"464"}]},"aon-center-westbound":{name:"Aon Center Westbound",options:[{transitType:"bus",stopId:"8613",routes:["20"]}],destinations:[{name:"Madison & Laflin",stopId:"464"}]},"sedgwick-southbound":{name:"Sedgwick Southbound",options:[{transitType:"train",stopId:"30156",routes:["Brown","Purple"]}],destinations:[{name:"Clark/Lake",stopId:"30075"}]},"belmont-southbound":{name:"Belmont Southbound",options:[{transitType:"train",stopId:"30258",routes:["Brown","Purple"]}],destinations:[{name:"Clark/Lake",stopId:"30075"}]},"adison-southbound":{name:"Addison Southbound",options:[{transitType:"train",stopId:"30274",routes:["Red"]}],destinations:[{name:"Lake",stopId:"30290"}]}}},8175:function(e,t,n){var a=n(6540),o=n(9197),s=n(7581),r=n(8490);const i=s.default.span.withConfig({displayName:"TransitIcon__BusIcon",componentId:"sc-1qjz7rx-0"})(["display:inline-block;background-color:",";color:white;padding:0px 2px;border-radius:4px;font-weight:600;text-align:center;min-width:24px;"],r.M.bus),l=(0,s.default)(o.b2D).withConfig({displayName:"TransitIcon__TrainIcon",componentId:"sc-1qjz7rx-1"})(["vertical-align:middle;font-size:20px;"]);t.A=e=>{let{type:t,route:n}=e;return"bus"===t?a.createElement(i,null,n):a.createElement("span",null,a.createElement(l,{color:(0,r.y)(n)}))}},8490:function(e,t,n){n.d(t,{M:function(){return a},y:function(){return o}});const a={primary:"#2166b1",bus:"#0b67be",alertRed:"#db0000"},o=e=>({Red:"#c60c30","Red Line":"#c60c30",Blue:"#00a1de","Blue Line":"#00a1de",Brown:"#62361b","Brown Line":"#62361b",Green:"#009b3a","Green Line":"#009b3a",Orange:"#f9461c","Orange Line":"#f9461c",Pink:"#e27ea6","Pink Line":"#e27ea6",Purple:"#522398","Purple Line":"#522398",Yellow:"#f9e300","Yellow Line":"#f9e300"}[e]||"#000000")}}]);
//# sourceMappingURL=component---src-templates-favorite-tsx-3f760a8e7cfa52d9cc23.js.map